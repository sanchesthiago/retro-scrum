@if (session()) {
  <div class="board-container">
    <header class="board-header">
      <div class="session-stats">
        <div class="stat">
          <strong>ğŸ‘¥ Participantes:</strong> {{ getTotalParticipants() }}
        </div>
        <div class="stat">
          <strong>âœ… Finalizados:</strong> {{ getFinishedCount() }}/{{ getTotalParticipants() }}
        </div>

        @if (session()!.isRevealed) {
          <div class="stat revealed">
            <strong>ğŸ‰ Cards Revelados!</strong>
          </div>
        } @else {
          <div class="stat hidden">
            <strong>ğŸ”’ Cards Ocultos</strong>
          </div>
        }

        <!-- Status da conexÃ£o -->
        <div class="stat connection" [class]="connectionStatus()">
          @switch (connectionStatus()) {
            @case ('connected') { âœ… Conectado }
            @case ('connecting') { â³ Conectando... }
            @case ('disconnected') { âŒ Offline }
          }
        </div>
      </div>

      <div class="board-controls">
        @if (!hasCurrentUserFinished() && !session()!.isRevealed) {
          <button (click)="markAsFinished()" class="finish-btn" [disabled]="isFinishing() || connectionStatus() !== 'connected'">
            @if (isFinishing()) {
              â³
            } @else {
              âœ… Finalizar
            }
          </button>
        }

        @if (allUsersFinished() && !session()!.isRevealed) {
          <button (click)="revealCards()" class="reveal-btn" [disabled]="isRevealing() || connectionStatus() !== 'connected'">
            @if (isRevealing()) {
              â³
            } @else {
              ğŸ‘€ Revelar Cards
            }
          </button>
        }

        @if (hasCurrentUserFinished() && !session()!.isRevealed) {
          <div class="waiting-message">
            â³ Aguardando outros participantes...
            ({{ getFinishedCount() }}/{{ getTotalParticipants() }})
          </div>
        }

        @if (session()!.isRevealed) {
          <div class="completed-message">
            âœ… DiscussÃ£o Liberada!
          </div>
        }
      </div>
    </header>

    <!-- Lista de participantes -->
    <div class="participants-list">
      <strong>Participantes:</strong>
      @for (participant of session()!.participants; track participant.name) {
        <span class="participant-tag" [class.finished]="participant.hasFinished">
          {{ participant.name }}{{ participant.hasFinished ? ' âœ…' : ' â³' }}
        </span>
      }
    </div>

    <!-- Mensagem informativa -->
    @if (!session()!.isRevealed) {
      <div class="info-message">
        <p>ğŸ“ <strong>Escreva seus cards</strong> - Eles aparecerÃ£o borrados para todos em tempo real</p>
        <p>âœ… <strong>Clique em "Finalizar"</strong> quando terminar de escrever</p>
        <p>ğŸ‘€ <strong>Quando todos finalizarem</strong> - Os cards serÃ£o revelados para discussÃ£o</p>
      </div>
    } @else {
      <div class="info-message revealed">
        <p>ğŸ‰ <strong>DiscussÃ£o liberada!</strong> - Todos os cards estÃ£o visÃ­veis</p>
        <p>ğŸ‘ <strong>Vote nos melhores cards</strong> clicando no botÃ£o de like</p>
      </div>
    }

    <!-- Colunas -->
    <div class="board-columns">
      @for (column of columns; track column.type) {
        <app-column
          [title]="column.title"
          [type]="column.type"
          [cards]="session()!.cards"
          [isRevealed]="session()!.isRevealed"
          [canAddCards]="canAddCards()"
          [isConnected]="connectionStatus() === 'connected'"
        ></app-column>
      }
    </div>
  </div>
}
